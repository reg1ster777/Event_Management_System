<!-- src/main/resources/static/index.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>高校学生活动全流程管理系统 - 首页</title>
    <style>
        /* 整体布局样式 */
        body {
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            padding: 18px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        header .title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        header .subtitle {
            font-size: 13px;
            opacity: 0.9;
        }

        .header-left {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
        }

        .header-right .admin-name {
            white-space: nowrap;
        }

        main {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 32px 16px;
        }

        .container {
            max-width: 1080px;
            width: 100%;
            display: flex;
            flex-wrap: wrap;
            gap: 32px;
            padding: 12px;
        }

        .intro {
            flex: 1 1 300px;
            padding: 16px;
        }

        .intro h1 {
            font-size: 26px;
            margin: 0 0 12px;
        }

        .intro p {
            font-size: 14px;
            color: #555;
            line-height: 1.6;
            margin: 0 0 8px;
        }

        .tag-list {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 999px;
            background: rgba(22, 119, 255, 0.08);
            color: #1677ff;
        }

        .cards {
            flex: 1 1 320px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .card {
            padding: 22px 22px 20px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .card-desc {
            font-size: 13px;
            color: #666;
            margin-bottom: 12px;
        }

        .btn-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-block;
            padding: 8px 14px;
            font-size: 13px;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.15s ease;
            user-select: none;
        }

        .btn-primary {
            color: #fff;
        }

        .btn-primary:hover {
            background: #165fcc;
            box-shadow: 0 4px 10px rgba(22, 119, 255, 0.35);
        }

        .btn-outline {
            background: #fff;
            color: #1677ff;
            border: 1px solid #1677ff;
        }

        .btn-outline:hover {
            background: rgba(22, 119, 255, 0.06);
        }

        .status {
            font-size: 12px;
            color: #777;
            margin-top: 8px;
        }

        .status span {
            font-weight: 500;
        }

        footer {
            text-align: center;
            font-size: 12px;
            color: #aaa;
            padding: 10px 0 14px;
        }

        code {
            background: #f2f2f2;
            padding: 1px 4px;
            border-radius: 3px;
            font-size: 12px;
        }

        @media (max-width: 768px) {
            main {
                padding: 16px 10px;
            }

            .container {
                flex-direction: column;
            }
        }
    </style>
    <link rel="stylesheet" href="/theme.css?v=2">
</head>
<body>
<header>
    <div class="header-left">
        <div class="title">高校学生活动全流程管理系统</div>
        <div class="subtitle">Spring Boot + MySQL · 支持活动发布、报名、签到与后台管理</div>
    </div>
    <div class="header-right" id="admin-info">
        <a href="/login.html">管理员登录</a>
    </div>
</header>

<main>
    <div class="container">
        <!-- 左侧介绍区域 -->
        <section class="intro">
            <h1>欢迎使用活动管理系统</h1>
            <p>
                本系统面向高校场景，提供从 <strong>活动创建 → 在线报名 → 现场签到 → 结果统计</strong> 的一体化管理流程。
            </p>
            <p>
                当前已实现的核心能力包括：
                管理员登录与管理、活动增删改查、学生在线报名、签到记录查询等。
            </p>
            <div class="tag-list">
                <div class="tag">活动管理</div>
                <div class="tag">在线报名</div>
                <div class="tag">签到统计</div>
                <div class="tag">Spring Boot</div>
                <div class="tag">MyBatis + MySQL</div>
            </div>
        </section>

        <!-- 右侧功能入口卡片 -->
        <section class="cards">
            <!-- 活动浏览入口 -->
            <div class="card">
                <div class="card-title">活动浏览</div>
                <div class="card-desc">
                    查看所有活动详情、当前报名人数与状态，并可跳转至后台页面进行查看与管理。
                </div>
                <div class="btn-row">
                    <a href="/admin-activities.html" class="btn btn-primary">查看活动信息</a>
                </div>
                <div class="status">活动列表接口：<code>GET /activities</code></div>
            </div>

            <!-- 新建活动入口 -->
            <div class="card">
                <div class="card-title">新建活动</div>
                <div class="card-desc">
                    管理员可跳转到专用页面创建新活动，填写信息后默认保存为“未发布”，再在列表中发布。
                </div>
                <div class="btn-row">
                    <a href="/admin-create-activity.html" class="btn btn-outline">去创建活动</a>
                </div>
                <div class="status">创建接口：<code>POST /activities</code></div>
            </div>

            <!-- 系统状态小卡片：简单检测后端是否正常 -->
            <div class="card">
                <div class="card-title">系统状态</div>
                <div class="card-desc">
                    下方会尝试调用 <code>GET /activities</code> 接口，检测后端是否正常运行及数据库连接是否正常。
                </div>
                <div id="health-status" class="status">检测中...</div>
            </div>
        </section>
    </div>
</main>

<footer>
    &copy; 2025 高校学生活动全流程管理系统 · 后端：Spring Boot &nbsp;|&nbsp; 数据库：MySQL
</footer>

<script>
    const adminInfoBox = document.getElementById('admin-info');

    function renderAdminInfo() {
        if (!adminInfoBox) return;
        const stored = localStorage.getItem('adminUser');
        if (!stored) {
            adminInfoBox.innerHTML = '<a href="/login.html">管理员登录</a>';
            return;
        }
        let user;
        try {
            user = JSON.parse(stored);
        } catch (err) {
            console.error('无法解析管理员信息', err);
            localStorage.removeItem('adminUser');
            adminInfoBox.innerHTML = '<a href="/login.html">管理员登录</a>';
            return;
        }
        const username = user?.username || '管理员';
        adminInfoBox.innerHTML = `
            <div class="admin-name">当前管理员：<strong>${username}</strong></div>
            <button type="button" id="logout-btn">退出登录</button>
        `;
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', () => {
                localStorage.removeItem('adminUser');
                renderAdminInfo();
            });
        }
    }

    // 简单检测 /activities 接口，看后端与数据库是否正常
    (async function checkBackendHealth() {
        const el = document.getElementById('health-status');
        try {
            const res = await fetch('/activities', { method: 'GET' });
            if (res.ok) {
                const data = await res.json();
                const count = Array.isArray(data) ? data.length : 0;
                el.innerHTML = `后端接口正常，可用活动数量：<span>${count}</span> 条。`;
            } else {
                el.innerHTML = `后端接口返回状态码：<span>${res.status}</span>，请检查日志。`;
            }
        } catch (e) {
            console.error(e);
            el.innerHTML = '无法连接到后端，请确认应用是否已启动、数据库配置是否正确。';
        }
    })();

    renderAdminInfo();
</script>
</body>
</html>
